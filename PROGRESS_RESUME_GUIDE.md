# Руководство по сохранению и восстановлению прогресса

## Как работает сохранение прогресса

1. **При запуске с `-progress`** — прогресс автоматически сохраняется в файл каждые N секунд (по умолчанию 120 сек = 2 минуты)
2. **Прогресс НЕ теряется** при перезапуске — файл остаётся на диске
3. **Чтобы продолжить с сохранённой позиции** — нужно использовать флаг `-resume`

## Варианты запуска

### 1. Новый поиск (начать сначала)

```bash
./run_gpu_range.sh
```

Начинает поиск сначала, даже если есть файл прогресса.

### 2. Продолжить с сохранённой позиции (рекомендуется)

```bash
./run_gpu_range_resume.sh
```

Автоматически проверит наличие `progress_gpu_range.dat`:
- **Если файл есть** — добавит флаг `-resume` и продолжит поиск с сохранённой позиции
- **Если файла нет** — начнёт новый поиск

### 3. Ручной запуск с resume

```bash
./VanitySearch -seg seg_gpu_range.txt -bits 71 -gpu -gpuId 0 -g 64,128 -t 2 -m 1000000 \
  -progress progress_gpu_range.dat -autosave 120 -resume \
  -o out_gpu_range.txt "1PWo3JeB9jr"
```

## Важно: что происходит при перезапуске

### Без `-resume` (просто перезапустили)
- ✅ Файл прогресса **НЕ удаляется** — он остаётся на диске
- ❌ Поиск **начинается сначала** с начальных границ сегментов
- ⚠️ Старый прогресс **не используется**, но и не теряется

### С `-resume` (правильный перезапуск)
- ✅ Файл прогресса **загружается**
- ✅ Поиск **продолжается** с сохранённых позиций в каждом сегменте
- ✅ Завершённые сегменты **пропускаются**
- ✅ Активные сегменты **продолжаются** с того места, где остановились

## Проверка наличия файла прогресса

```bash
ls -lh progress_gpu_range.dat
```

Если файл существует, можно продолжить поиск с флагом `-resume`.

## Просмотр сохранённого прогресса

```bash
# Детальный просмотр (если установлен Python3)
python3 show_segment_progress.py seg_gpu_range.txt progress_gpu_range.dat

# Или упрощённый (без Python)
./show_segment_progress_simple.sh seg_gpu_range.txt progress_gpu_range.dat
```

## Что делать если файл прогресса не найден

Ошибка:
```
Ошибка: не удалось загрузить прогресс из progress_gpu_range.dat
Убедитесь что поиск запущен с параметром -progress
```

Причины:
1. Поиск ещё не запускался с параметром `-progress`
2. Файл ещё не создался (поиск только что запустился, прошло меньше 2 минут)
3. Файл в другом каталоге

Решение:
1. Проверьте что поиск запущен: `pgrep -fl VanitySearch`
2. Подождите 2-3 минуты после запуска (первое сохранение происходит через `AUTOSAVE_INTERVAL` секунд)
3. Проверьте что файл появился: `ls -lh progress_gpu_range.dat`

## Рекомендации

**Всегда используйте `run_gpu_range_resume.sh`** вместо `run_gpu_range.sh` — он автоматически продолжит с сохранённой позиции если файл прогресса есть, и начнёт сначала если его нет.

